# 스코프란?

자바스크립트를 포함한 모든 프로그래밍 언어의 기본적이고 중요한 개념인 스코프에 대해서 알아본다.

## 스코프의 정의

<br/>

모든 식별자 (변수 이름, 함수 이름, 클래스 이름 등)는 자신이 선언된 위치에 의해 다른 코드가 식별자 자신을 참조할 수 있는 유효 범위가 결정되는데, 이를 <b>스코프</b>라고 한다.

쉽게 말하자면 스코프는 <b><u>식별자가 유효한 범위</u></b>를 말한다.

<br/>

```javascript
function example() {
	let temp = "함수안에서 정의한 변수";
	// temp는 오직 example 함수 내부에서만 사용 가능하다

	console.log(temp); //  "함수안에서 정의한 변수"
}

console.log(temp); // ReferenceError: temp is not defined
```

위의 예제에서 `temp`라는 변수의 스코프는 함수 몸체 내부이기 때문에 함수 외부에서 `temp`를 호출 했을 때 참조 에러가 발생한다.

<br/>

```javascript
let x = "전역 변수";

function foo() {
	let x = "로컬 변수";
	console.log(x);
}

foo(); // "로컬 변수"

console.log(x); // "전역 변수"
```

위의 예제에서는 `x`라는 같은 이름은 가진 변수가 상황에 따라 다르게 호출됨을 보여준다.

자바스크립트 엔진은 이름이 같은 두 개의 변수 중에서 어떤 변수를 참조해야 할 것인지 결정해야 하는데, 이것을 <b><u>식별자 결정</u></b>이라고 한다. 식별자 결정을 할 때는 스코프를 통해 어떤 변수를 참조해야 할지 결정하게 된다.

따라서 스코프란 <b><u>자바스크립트 엔진이 식별자를 검색할 때 사용하는 규칙</u></b>이라고도 할 수 있다.

## 스코프의 종류

<br/>

| 구분 |         설명          |   스코프    |   변수    |
| :--: | :-------------------: | :---------: | :-------: |
| 전역 | 코드의 가장 바깥 영역 | 전역 스코프 | 전역 변수 |
| 지역 |    함수 몸체 내부     | 지역 스코프 | 지역 변수 |

코드는 전역(global)과 지역(local)로 구분할 수 있다.

변수는 <b><u>자신이 선언된 위치에 의해 자신이 유효한 범위인 스코프가 결정</u></b>되며, 전역에서 선언된 변수는 전역 스코프를 가지고 지역에서 선언된 변수는 지역스코프를 갖게 된다.

<br/>

```javascript
let x = "global x";
let y = "global y";

function outer() {
	let z = "outer's local z";

	console.log(x); // "global x"
	console.log(y); // "global y"
	console.log(z); // "outer's local z"

	function inner() {
		let x = "inner's local x";

		console.log(x); // "inner's local x"
		console.log(y); // "global y"
		console.log(z); // "outer's local z"
	}

	inner();
}

outer();

console.log(x); // "global x"
console.log(z); // ReferenceError: z is not defined
```

위 코드에서 전역에서 선언된 <b><u>`global`을 포함한 변수를 전역 스코프를 갖는 전역변수</u></b>, 함수 내부에서 선언된 <b><u>`local`을 포함한 변수를 지역 스코프를 갖는 지역 변수</u></b> 라고 할 수 있다.

### 전역 변수

전역은 코드 가장 바깥 영역을 말하며, 전역으로 선언된 변수는 코드 내부 어디서든지 참조할 수 있다.

### 지역 변수

지역 변수를 말할 때 지역이란 <b><u>함수 몸체 내부</u></b>를 말한다. 지역 변수는 자신의 지역 스코프와 하위 지역 스코프에서 유효하다.

### 스코프 체인

여기서 주목할 점은 함수 내부에서 변수를 호출 할 경우 `inner 지역 스코프 → outer 지역 스코프 → 전역 스코프` 순으로 호출된 함수 기준으로 변수를 검색하고 출력하는 것인데,

이렇게 함수의 중첩에 의해 계층적 구조를 가진다는 것을 <b><u>스코프 체인</u></b> 이라고 한다.

자바 스크립트 엔진은 스코프 체인을 통해 변수를 참조하는 코드의 스코프에서 시작해서 상위 스코프 방향으로 이동하며 변수를 검색한다.

## 함수 레벨 스코프

<br/>

자바스크립트에서 지역은 함수 몸체 내부를 말하고, 지역은 지역 스코프를 만든다. 이것은 <b><u>코드 블록이 아닌 함수에 의해서 지역 스코프가 생성된다는 의미</u></b>이다.

특히 `var` 키워드로 선언된 변수는 오로지 함수의 코드 블록 (함수 몸체)만을 지역 스코프로 인정하고, 이것을 <b><u>함수 레벨 스코프</u></b>라고 한다.

## 블록 레벨 스코프

<br/>

`var` 키워드로 선언한 변수는 함수의 코드 블록을 지역 스코프로 인정하지만, `let`과 `const`로 선언한 변수는 C나 자바등 대부분의 프로그래밍 언어처럼 모든 코드 블록(함수, if문, for문, while문 등)
을 지역 스코프로 인정한다.

이렇게 모든 코드 블록을 스코프로 인정하는 것을 <b><u>블록 레벨 스코프</u></b>라고 한다.

::: details 함수 레벨 스코프와 블록 레벨 스코프

<br/>

```javascript
// 전역에서 선언된 변수이기 때문에 전역 스코프를 가진다
let i = 10;

function foo() {
	// 함수 내부에서 선언된 변수이기 때문에 함수 레벨 스코프를 가진다
	let i = 100;

	for (let i = 0; i <= 3; i++) {
		// for문까지 스코프로 인정하기 때문에 여기서 i값은 블록 레벨 스코프이다.
		console.log(i); // 1 2 3
	}

	console.log(i); // 100
}

console.log(i); // 10
```

:::

### 참고 자료

-   [스코프 - MDN](https://developer.mozilla.org/ko/docs/Glossary/Scope)
-   이웅모, 『모던 자바스크립트 Deep Dive』, 위키북스
